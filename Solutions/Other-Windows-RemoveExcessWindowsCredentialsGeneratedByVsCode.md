---
title: Windows - VsCodeå¯¼è‡´Windowså‡­æ®è¿‡å¤šä¹‹ä¸€é”®åˆ é™¤
title_en: "One-Click Script to Delete Excess Windows Credentials Generated by VSCode"
date: 2026-02-21 11:01:49
tags: [å…¶ä»–, Windows, VsCode, bash]
categories: [æŠ€æœ¯æ€è€ƒ]
index_img: https://cors.letmefly.xyz/https://i-blog.csdnimg.cn/direct/6c59a244603d43fb9ab75cff4c962e2a.png
---

# Windows - VsCodeå¯¼è‡´Windowså‡­æ®è¿‡å¤šä¹‹ä¸€é”®åˆ é™¤

## èµ·å› 

éƒ½2026å¹´äº†ï¼Œç”µè„‘ä¸ŠGithub CLI `gh`ç‰ˆæœ¬è¿˜æ˜¯2023å¹´çš„`gh version 2.32.1 (2023-07-24)`ï¼Œä¸æ”¯æŒ[å¤šè´¦å·](https://github.com/LetMeFly666/LeetCode/pull/1401)ç™»å½•ç­‰ä¸€äº›ç‰¹æ€§ï¼Œæ›´æ¢æ–°ç‰ˆæœ¬`gh version 2.87.0 (2026-02-18)`åè¿è¡ŒæŠ¥é”™ï¼š

```bash
failed to migrate config: cowardly refusing to continue with multi account migration: couldn't migrate oauth token for "github.com": Not enough memory resources are available to process this command.
# æˆ–è€…æŠ¥é”™ï¼š
failed to move active token in keyring: Not enough memory resources are available to process this command.
```

æˆ‘64Gçš„å†…å­˜è·‘ä¸äº†ä¸€ä¸ªghèº«ä»½tokençš„è¿ç§»ï¼Ÿ(bushi)ï¼Œä¸€æœå‘ç°Github Desktop([#15217](https://github.com/desktop/desktop/issues/15217))æœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œ[è¯„è®º](https://github.com/desktop/desktop/issues/15217#issuecomment-1491979890)è¯´åˆ ä¸ªæ—§å‡­æ®å¯èƒ½æœ‰æ•ˆã€‚

ä¸€çœ‹å‡­æ®ï¼Œå‘ç°æœ‰å¤§é‡çš„2022-2023å¹´é—´VsCodeå­˜å‚¨çš„å¾®è½¯è´¦å·ç™»å½•å‡­æ®ï¼ŒæŒ‡å®šæ˜¯å½“æ—¶è®¾è®¡çš„æœ‰ç‚¹é—®é¢˜ã€‚

![å¤§é‡VsCodeå­˜å‚¨çš„MSé‰´æƒå‡­æ®çš„éƒ¨åˆ†](https://cors.letmefly.xyz/https://i-blog.csdnimg.cn/direct/6c59a244603d43fb9ab75cff4c962e2a.png)

æ˜¯æ—¶å€™åˆ é™¤å¤šä½™å‡­æ®äº†ã€‚

## è„šæœ¬æ‰¹é‡åˆ é™¤

ç²—ç•¥ä¼°è®¡è¿™æ ·çš„å‡­æ®è‡³å°‘æœ‰100ä¸ªï¼Œæ‰‹åŠ¨åˆ é™¤è‚¯å®šä¸æ˜¯ç¨‹åºå‘˜çš„ä½œé£ï¼Œäºæ˜¯(å‡ è½®å¯¹è¯)è®©è±†åŒ…å†™äº†ä¸ªè„šæœ¬ï¼š

<script src="https://web.letmefly.xyz/Links/JS/GithubGists/RmWindowsCredentials/5fc6647e2f5289a656d2441229cdd392.js"></script>

<details><summary>script</summary>


```powershell
# å¼ºåˆ¶è¦æ±‚ç®¡ç†å‘˜æƒé™
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Start-Process powershell.exe "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

# åŒ¹é…åŒ…å« vscodevscode çš„ LegacyGeneric ç±»å‹å‡­æ®
$matchKeyword = "vscodevscode"

try {
    Write-Host "=== æ­£åœ¨è¯»å–æ‰€æœ‰Windowså‡­æ® ===" -ForegroundColor Cyan
    $allCreds = cmdkey /list
    $targetCreds = @()

    # ç²¾å‡†è§£ææ ¼å¼ï¼šç›®æ ‡: LegacyGeneric:target=xxx
    foreach ($line in $allCreds) {
        # åŒ¹é…åŒ…å« LegacyGeneric:target= ä¸”æœ‰ vscodevscode çš„è¡Œ
        if ($line -match "ç›®æ ‡:\s*LegacyGeneric:target=(.*$matchKeyword.*)") {
            $credFullName = $matches[1].Trim()
            # æ‹¼æ¥å®Œæ•´çš„åˆ é™¤å‚æ•°ï¼ˆå¿…é¡»å¸¦ LegacyGeneric:target= å‰ç¼€ï¼‰
            $fullTarget = "LegacyGeneric:target=$credFullName"
            $targetCreds += $fullTarget
        }
    }

    # å¤„ç†åŒ¹é…ç»“æœ
    if ($targetCreds.Count -eq 0) {
        Write-Host "`nâŒ æœªæ‰¾åˆ°åŒ…å« '$matchKeyword' çš„å‡­æ®" -ForegroundColor Red
        Read-Host "æŒ‰å›è½¦é€€å‡º"
        exit
    }

    Write-Host "`nâœ… æ‰¾åˆ° $($targetCreds.Count) ä¸ªVSCodeç›¸å…³å‡­æ®ï¼š" -ForegroundColor Green
    $targetCreds | ForEach-Object { Write-Host "  - $_" }

    # ç¡®è®¤åˆ é™¤
    $confirm = Read-Host "`næ˜¯å¦ç¡®è®¤åˆ é™¤è¿™äº›å‡­æ®ï¼Ÿ(Y/N)"
    if ($confirm -notmatch "^[Yy]$") {
        Write-Host "`nğŸš« ç”¨æˆ·å–æ¶ˆåˆ é™¤" -ForegroundColor Yellow
        Read-Host "æŒ‰å›è½¦é€€å‡º"
        exit
    }

    # æ‰§è¡Œåˆ é™¤ï¼ˆå…³é”®ï¼šå¿…é¡»ç”¨å®Œæ•´çš„ LegacyGeneric:target=xxx ä½œä¸ºåˆ é™¤å‚æ•°ï¼‰
    $deleted = 0
    foreach ($cred in $targetCreds) {
        try {
            # ç”¨cmdè°ƒç”¨é¿å…PowerShellè½¬ä¹‰é—®é¢˜
            $output = cmd /c "cmdkey /delete:`"$cred`"" 2>&1
            if ($LASTEXITCODE -eq 0) {
                Write-Host "âœ… å·²åˆ é™¤ï¼š$cred" -ForegroundColor Green
                $deleted++
            } else {
                Write-Host "âŒ åˆ é™¤å¤±è´¥ï¼š$cred (é”™è¯¯ï¼š$output)" -ForegroundColor Red
            }
        }
        catch {
            Write-Host "âŒ åˆ é™¤å¼‚å¸¸ï¼š$cred (é”™è¯¯ï¼š$($_.Exception.Message))" -ForegroundColor Red
        }
    }

    Write-Host "`nğŸ“Š åˆ é™¤å®Œæˆï¼æˆåŠŸåˆ é™¤ $deleted / $($targetCreds.Count) ä¸ªå‡­æ®" -ForegroundColor Green
}
catch {
    Write-Host "`nâŒ è„šæœ¬æ‰§è¡Œå‡ºé”™ï¼š$($_.Exception.Message)" -ForegroundColor Red
}

Read-Host "æŒ‰å›è½¦é€€å‡º"
```

</details>

ä½¿ç”¨**è®°äº‹æœ¬**å¦å­˜ä¸º`xx.ps1`ï¼Œç¼–ç ä¸º`ANSI`ï¼Œç®¡ç†å‘˜èº«ä»½å¯åŠ¨powershellï¼Œè¾“å…¥è¿™ä¸ªè„šæœ¬çš„è·¯å¾„å¹¶å›è½¦ï¼Œè„šæœ¬ä¼šå…ˆåˆ—ä¸¾å‡ºä»¥`vscodevscode.`å¼€å¤´çš„å‡­æ®ï¼ŒæŒ‰`Y`å›è½¦å¯ä»¥æ‰¹é‡åˆ é™¤ï¼Œä¸–ç•Œå¼€å§‹å˜å¾—æ¸…å‡€äº†ã€‚

## End

åˆ äº†å½“å¹´ç•™ä¸‹çš„182ä¸ªå‡­æ®åï¼Œ`gh`è¡¨ç°æ­£å¸¸äº†ã€‚

<center><font size="6px" face="Ink Free">The Real End, Thanks!</font></center>

> åŒæ­¥å‘æ–‡äº[CSDN](https://letmefly.blog.csdn.net/article/details/158262243)å’Œæˆ‘çš„[ä¸ªäººåšå®¢](https://blog.letmefly.xyz/)ï¼ŒåŸåˆ›ä¸æ˜“ï¼Œè½¬è½½ç»ä½œè€…åŒæ„åè¯·é™„ä¸Š[åŸæ–‡é“¾æ¥](https://blog.letmefly.xyz/2026/02/21/Other-Windows-RemoveExcessWindowsCredentialsGeneratedByVsCode/)å“¦~
>
> åƒç¯‡æºç é¢˜è§£[å·²å¼€æº](https://github.com/LetMeFly666/LeetCode)