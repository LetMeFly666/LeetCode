<!--
 * @Author: LetMeFly
 * @Date: 2025-06-16 12:45:30
 * @LastEditors: LetMeFly.xyz
 * @LastEditTime: 2025-06-22 14:47:28
-->
# “安装包”、傻瓜式说明整理

本次打包了包括OWA图片信标、webex双信息解密两大部分。

详情请见installer压缩包

# 详细说明整理

# webex可用性探究

在学弟的帮助下成功登录了webex并发送消息。

webex确实没找到合并转发功能，但是其功能有些类似飞书，可以**引用**、**编辑**、**转发**、消息固定、定时提醒、表情、会议、语音、文件、白板、插件等等，还有消息空间的“密钥保护”。

![消息发送](pics/01-webex-message-forward.png)

并且支持消息链接（这是一个本来就有的合法行为）：

```
webexteams://im?space=388bc8a0-4f23-11f0-9978-197e3894c22a&s=jahlfsjskljfljjjjjj&message=5ce38670-4f23-11f0-8dc1-cf25d4d2274c
```

中间的`&s=jahlfsjskljfljjjjjj`是我加的，输入浏览器回车仍然可以打开webex并定位到消息

![](pics/02-message-link.png)

![](pics/03-message-link.png)

![](pics/04-message-link.png)

还能让消息看起来是不带中间的`s=xxx`但实际上是带的

![](pics/05-link.png)

![](pics/06-link.png)

这种消息甚至不影响鼠标悬停预览

![](pics/07-link.png)

然后我写了个简单的flask重定向服务

```python
from flask import Flask, redirect, request

app = Flask(__name__)

@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def redirect_all(path):
    full_path = request.full_path.strip('?')
    target_url = full_path.lstrip('/')
    return redirect(target_url, code=302)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=6000, debug=True)
```

预期是访问：

```
http://127.0.0.1:6000/webexteams://im?space=388bc8a0-4f23-11f0-9978-197e3894c22a&s=ljsjfl&message=5ce38670-4f23-11f0-8dc1-cf25d4d2274c
```

和访问：

```
webexteams://im?space=388bc8a0-4f23-11f0-9978-197e3894c22a&s=ljsjfl&message=5ce38670-4f23-11f0-8dc1-cf25d4d2274c
```

效果相同，但实际却`ERR_UNSAFE_PORT`了

![](pics/08-unsafe-port.png)

但是在postman中试了下发现是正常的。后面发现是Chrome默认认为6000端口是不安全端口(6000端口是X11协议使用的第一个端口，并且它已经被IANA官方分配给X11了：[参考链接](https://www.reddit.com/r/firefox/comments/ttms50/since_when_was_this_a_thing_in_firefox_trying_to/?tl=zh-hans))，不让访问，修改为其他端口即可。

```python
# http://127.0.0.1:6000/webexteams://im?space=388bc8a0-4f23-11f0-9978-197e3894c22a&s=ljsjfl&message=5ce38670-4f23-11f0-8dc1-cf25d4d2274c
from flask import Flask, redirect, request

app = Flask(__name__)

@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def redirect_all(path):
    full_path = request.full_path.strip('?')
    target_url = full_path.lstrip('/')
    return redirect(target_url, code=302)

if __name__ == '__main__':
    app.run(host='127.0.0.1', port=5000, debug=True)
```

访问：

```
http://127.0.0.1:5000/webexteams://im?space=388bc8a0-4f23-11f0-9978-197e3894c22a&s=ljsjfl&message=5ce38670-4f23-11f0-8dc1-cf25d4d2274c
```

然后就成功访问了：

![](pics/09-success-access.png)

![](pics/10-success-access.png)

并且我们的服务也得到了参数

![](pics/11-got-params.png)

如果还想继续，甚至可以在后端服务拿到参数`s`后重定向之前处理一下，把`s`参数抹去，这样重定向到webex后webex就无法察觉了。

如果浏览器中勾选“始终允许”则会不经提示直接打开webex，全程无感（感知不到中间经过我们的服务器重定向了一次）

并且由于密文之需要获取一次，所以我也可以设置成301永久重定向，下次访问的话直接不经过我们的服务器，浏览器就直接重定向到webex了。