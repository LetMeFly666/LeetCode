<h2><a id="Windows__ssh___1"></a>Windows(奇思妙想) - 通过ssh打开带有图形界面的程序 - 一种通过计划任务的曲折实现方式</h2> <br><h3><a id="_3"></a>前言</h3> <br><p>Windows启用OpenSSH客户端后就可以通过SSH的方式访问Windows了。但是通过SSH启动的程序：</p> <br><ol><li>无法显示图形界面</li><li>会随着SSH进程的结束而结束</li></ol> <br><p>于是想到了一种通过执行“计划任务”的方式脱离SSH以本机的名义执行不随SSH进程结束而结束的带图形界面的应用程序的方式。</p> <br><h3><a id="WindowsSSH_12"></a>Windows开启SSH</h3> <br><p>这个教程一搜一大把，这里仅仅列举主要内容以及容易踩坑的地方。</p> <br><p>如何开启并连接：</p> <br><ol><li>在<code>Windows设置–>应用–>应用和功能-可选功能</code>安装<code>OpenSSH客户端</code>（过程可能十分缓慢，魔法也难以加速）。</li><li>启动<code>OpenSSH SSH Server(sshd)</code>服务。（可在<code>services.msc</code>通过鼠标启动，也通过命令行<code>net start sshd</code>启动）。</li><li>保证局域网或公网可访问目标主机，在另一台机器上执行<code>ssh 用户名@ip地址</code>并输入密码即可。</li></ol> <br><p>踩坑：</p> <br><ol><li>如果你是正版Windows并登录了微软账号，有可能你输入系统用户名和开机密码无法访问，但是输入你的微软账户邮箱和密码可以正常登录控制。</li></ol> <br><h3><a id="SSH_26"></a>直接通过SSH启动其他程序效果不尽人意</h3> <br><p>有了终端，似乎一切都可以执行了。但是当我想执行带“图形界面”的<code>爱心.exe</code>时，若执行<code>start 爱心.exe</code>，则目标主机和你的主机上都没有任何踪迹，但是可以在任务管理器中看到。</p> <br><p><img src="https://i-blog.csdnimg.cn/direct/8fca3be9af1443b9897f432edf83b7bf.png" alt="在后台执行并且不显示界面" /></p> <br><p>可以发现<code>爱心.exe</code>在后台执行了，但是不会显示界面。这时候如果断开<code>ssh</code>进程连接，则后台的<code>爱心.exe</code>也会随之消失。</p> <br><p>大概是因为：</p> <br><blockquote> <br> <p><s>在Windows系统中通过SSH启动GUI程序时无法显示界面，通常是因为SSH会话与图形界面会话隔离导致的。SSH连接默认运行在非交互式控制台会话（通常为Session0），而图形界面程序需要运行在用户的交互式桌面会话（如Session1）</s>（未验证）</p> <br></blockquote> <br><h3><a id="UI_38"></a>通过任务计划启动UI程序</h3> <br><p>也就是说，如果能让Windows以为是它自己启动的一个程序，而不是<code>SSH</code>调用执行的一个后台程序，就可以正常执行显示界面并且不受SSH进程的约束了。</p> <br><p>Windows自己启动一个程序？任务计划不就是干这个的么？</p> <br><blockquote> <br> <p>理论上，我创建一个到时间自动运行<code>爱心.exe</code>的任务计划，Windows到时间自己运行这个程序，那不就脱离我的ssh进程并且能正常显示界面了吗？</p> <br> <p>甚至，我直接通过SSH调用命令“立即执行这个计划任务”，是不是就达到了我想要的效果？</p> <br></blockquote> <br><p>于是思路就变成了<code>创建执行爱心.exe的任务计划 -> 立即执行任务 -> 删除任务计划</code>。</p> <br><pre><code class="prism language-batch">schtasks /create /tn "tempStartAiXin" /sc ONCE /tr "cmd /c start 爱心.exe" /ru %USERNAME% /st 00:00<br>schtasks /run /tn "tempStartAiXin"<br>schtasks /delete /tn "tempStartAiXin" /f<br></code></pre> <br><p>完美！<code>爱心.exe</code>在目标主机上成功运行，且不随我ssh会话的结束而终结。</p> <br><h3><a id="End_58"></a>End</h3> <br><blockquote> <br> <p>同步发文于<a href="https://letmefly.blog.csdn.net/article/details/145786262" rel="nofollow">CSDN</a>和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2025/02/21/Other-Windows-OpenUIbySSH/" rel="nofollow">原文链接</a>哦~</p> <br></blockquote>