<h2><a id="LetMeFly2976_Ifloyd_1"></a>【LetMeFly】2976.转换字符串的最小成本 I：floyd算法(全源最短路)</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/minimum-cost-to-convert-string-i/" rel="nofollow">https://leetcode.cn/problems/minimum-cost-to-convert-string-i/</a></p> <br><p>给你两个下标从 <strong>0</strong> 开始的字符串 <code>source</code> 和 <code>target</code> ，它们的长度均为 <code>n</code> 并且由 <strong>小写 </strong>英文字母组成。</p> <br><p>另给你两个下标从 <strong>0</strong> 开始的字符数组 <code>original</code> 和 <code>changed</code> ，以及一个整数数组 <code>cost</code> ，其中 <code>cost[i]</code> 代表将字符 <code>original[i]</code> 更改为字符 <code>changed[i]</code> 的成本。</p> <br><p>你从字符串 <code>source</code> 开始。在一次操作中，<strong>如果 </strong>存在 <strong>任意</strong> 下标 <code>j</code> 满足 <code>cost[j] == z</code>  、<code>original[j] == x</code> 以及 <code>changed[j] == y</code> 。你就可以选择字符串中的一个字符 <code>x</code> 并以 <code>z</code> 的成本将其更改为字符 <code>y</code> 。</p> <br><p>返回将字符串 <code>source</code> 转换为字符串 <code>target</code> 所需的<strong> 最小 </strong>成本。如果不可能完成转换，则返回 <code>-1</code> 。</p> <br><p><strong>注意</strong>，可能存在下标 <code>i</code> 、<code>j</code> 使得 <code>original[j] == original[i]</code> 且 <code>changed[j] == changed[i]</code> 。</p> <br><p> </p> <br><p><strong class="example">示例 1：</strong></p> <br><pre><strong>输入：</strong>source = "abcd", target = "acbe", original = ["a","b","c","c","e","d"], changed = ["b","c","b","e","b","e"], cost = [2,5,5,1,2,20]<br><strong>输出：</strong>28<br><strong>解释：</strong>将字符串 "abcd" 转换为字符串 "acbe" ：<br>- 更改下标 1 处的值 'b' 为 'c' ，成本为 5 。<br>- 更改下标 2 处的值 'c' 为 'e' ，成本为 1 。<br>- 更改下标 2 处的值 'e' 为 'b' ，成本为 2 。<br>- 更改下标 3 处的值 'd' 为 'e' ，成本为 20 。<br>产生的总成本是 5 + 1 + 2 + 20 = 28 。<br>可以证明这是可能的最小成本。<br></pre> <br><p><strong class="example">示例 2：</strong></p> <br><pre><strong>输入：</strong>source = "aaaa", target = "bbbb", original = ["a","c"], changed = ["c","b"], cost = [1,2]<br><strong>输出：</strong>12<br><strong>解释：</strong>要将字符 'a' 更改为 'b'：<br>- 将字符 'a' 更改为 'c'，成本为 1 <br>- 将字符 'c' 更改为 'b'，成本为 2 <br>产生的总成本是 1 + 2 = 3。<br>将所有 'a' 更改为 'b'，产生的总成本是 3 * 4 = 12 。<br></pre> <br><p><strong class="example">示例 3：</strong></p> <br><pre><strong>输入：</strong>source = "abcd", target = "abce", original = ["a"], changed = ["e"], cost = [10000]<br><strong>输出：</strong>-1<br><strong>解释：</strong>无法将 source 字符串转换为 target 字符串，因为下标 3 处的值无法从 'd' 更改为 'e' 。<br></pre> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li><code>1 <= source.length == target.length <= 10<sup>5</sup></code></li><li><code>source</code>、<code>target</code> 均由小写英文字母组成</li><li><code>1 <= cost.length== original.length == changed.length <= 2000</code></li><li><code>original[i]</code>、<code>changed[i]</code> 是小写英文字母</li><li><code>1 <= cost[i] <= 10<sup>6</sup></code></li><li><code>original[i] != changed[i]</code></li></ul> <br><h3><a id="floyd_66"></a>解题方法：floyd算法</h3> <br><p>如何将<code>source</code>字符串变为<code>target</code>字符串？必须一个字符一个字符地通过<code>cost[i]</code>的代价将<code>original[i]</code>变为<code>changed[i]</code>来实现。</p> <br><p>不难发现<code>source</code>中每个字符是独立的，并且从一个字符<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        a<br>       <br>      <br>      <br>       a<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></span>经过数次变化最终变为字符<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        b<br>       <br>      <br>      <br>       b<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span>的最小代价也是固定的，所以我们不妨先计算出<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        26<br>       <br>       <br>        ×<br>       <br>       <br>        26<br>       <br>      <br>      <br>       26\times 26<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">26</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">26</span></span></span></span></span>种字母的转换方式分别最少需要花费多少代价：</p> <br><blockquote> <br> <p>将26个字母看成图中26个顶点，</p> <br> <p>假设通过<code>cost[i]</code>的代价可以将<code>original[i]</code>变为<code>changed[i]</code>，那么就看作有一个从节点<code>original[i]</code>指向节点<code>changed[i]</code>且代价为<code>cost[i]</code>的边。</p> <br> <p>floyd算法最适合算这个了，初始化<code>floyd[i][i]=0</code>，有直接a指向b的边的初始化<code>floyd[a][b]</code>为a指向b中代价最小的边，其他初始化为正无穷。然后：</p> <br> <pre><code class="prism language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> floyd<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre> <br> <p>就计算出任何一个字母转为另一个字母的最小代价了。</p> <br></blockquote> <br><p>对original字符串中每个字母做最小代价转换，累加并返回答案或-1即可。</p> <br><ul><li>时间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         l<br>        <br>        <br>         e<br>        <br>        <br>         n<br>        <br>        <br>         (<br>        <br>        <br>         o<br>        <br>        <br>         r<br>        <br>        <br>         i<br>        <br>        <br>         g<br>        <br>        <br>         i<br>        <br>        <br>         n<br>        <br>        <br>         a<br>        <br>        <br>         l<br>        <br>        <br>         )<br>        <br>        <br>         +<br>        <br>        <br>         l<br>        <br>        <br>         e<br>        <br>        <br>         n<br>        <br>        <br>         (<br>        <br>        <br>         o<br>        <br>        <br>         r<br>        <br>        <br>         i<br>        <br>        <br>         g<br>        <br>        <br>         i<br>        <br>        <br>         n<br>        <br>        <br>         a<br>        <br>        <br>         l<br>        <br>        <br>         )<br>        <br>        <br>         +<br>        <br>        <br>         <br>          C<br>         <br>         <br>          2<br>         <br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(len(original)+len(original)+C^2)<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">ina</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">ina</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         C<br>        <br>        <br>         =<br>        <br>        <br>         16<br>        <br>       <br>       <br>        C=16<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">16</span></span></span></span></span></li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         <br>          C<br>         <br>         <br>          2<br>         <br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(C^2)<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ul> <br><h4><a id="AC_95"></a>AC代码</h4> <br><h5><a id="C_97"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token comment">/*<br> * @LastEditTime: 2026-01-31 12:22:44<br> */</span><br><span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">minimumCost</span><span class="token punctuation">(</span>string source<span class="token punctuation">,</span> string target<span class="token punctuation">,</span> vector<span class="token operator"><</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">&</span> original<span class="token punctuation">,</span> vector<span class="token operator"><</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">&</span> changed<span class="token punctuation">,</span> vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> cost<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        ll floyd<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>        <span class="token function">memset</span><span class="token punctuation">(</span>floyd<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>floyd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> original<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">int</span> x <span class="token operator">=</span> original<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span><br>            <span class="token keyword">int</span> y <span class="token operator">=</span> changed<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span><br>            floyd<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>floyd<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ll<span class="token punctuation">)</span>cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> <span class="token number">26</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                    floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> floyd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> floyd<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <br>        ll ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> source<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            ll cost <span class="token operator">=</span> floyd<span class="token punctuation">[</span>source<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cost <span class="token operator">></span> <span class="token number">1000000000000</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            ans <span class="token operator">+=</span> cost<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><p>对了，邀请你看几个好看的hash：</p> <br><ul><li> <br>  <ol><li><a href="https://github.com/LetMeFly666/LeetCode/commit/8888a42d8ea3df034501423ce2939f8fca414b2b">8888a4</a></li></ol> </li><li> <br>  <ol start="2"><li><a href="https://github.com/LetMeFly666/LeetCode/commit/00009f1f1c0ff2f4119c43f50a25d25f3ab02dc4">00009f</a></li></ol> </li><li> <br>  <ol start="3"><li><a href="https://github.com/LetMeFly666/LeetCode/commit/000097a21d98f8ea26956d8875cd40e7a67ff1fd">000097</a></li></ol> </li></ul> <br><p>还带签名的。</p> <br><blockquote> <br> <p>同步发文于<a href="https://letmefly.blog.csdn.net/article/details/157581785" rel="nofollow">CSDN</a>和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2026/01/31/LeetCode%202976.%E8%BD%AC%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%8F%E6%88%90%E6%9C%ACI/" rel="nofollow">原文链接</a>哦~</p> <br> <p>千篇源码题解<a href="https://github.com/LetMeFly666/LeetCode">已开源</a></p> <br></blockquote>