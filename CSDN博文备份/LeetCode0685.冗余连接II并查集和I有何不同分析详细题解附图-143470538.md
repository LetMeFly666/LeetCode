<h2><a id="LetMeFly685_III_1"></a>【LetMeFly】685.冗余连接 II：并查集（和I有何不同分析）——详细题解(附图)</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/redundant-connection-ii/" rel="nofollow">https://leetcode.cn/problems/redundant-connection-ii/</a></p> <br><p>在本问题中，有根树指满足以下条件的 <strong>有向</strong> 图。该树只有一个根节点，所有其他节点都是该根节点的后继。该树除了根节点之外的每一个节点都有且只有一个父节点，而根节点没有父节点。</p> <br><p>输入一个有向图，该图由一个有着 <code>n</code> 个节点（节点值不重复，从 <code>1</code> 到 <code>n</code>）的树及一条附加的有向边构成。附加的边包含在 <code>1</code> 到 <code>n</code> 中的两个不同顶点间，这条附加的边不属于树中已存在的边。</p> <br><p>结果图是一个以边组成的二维数组 <code>edges</code> 。 每个元素是一对 <code>[u<sub>i</sub>, v<sub>i</sub>]</code>，用以表示 <strong>有向 </strong>图中连接顶点 <code>u<sub>i</sub></code> 和顶点 <code>v<sub>i</sub></code> 的边，其中 <code>u<sub>i</sub></code> 是 <code>v<sub>i</sub></code> 的一个父节点。</p> <br><p>返回一条能删除的边，使得剩下的图是有 <code>n</code> 个节点的有根树。若有多个答案，返回最后出现在给定二维数组的答案。</p> <br><p> </p> <br><p><strong class="example">示例 1：</strong></p> <br><img alt="" src="https://img-blog.csdnimg.cn/img_convert/d985ef37fab71366519eece6326b72b1.jpeg" /> <br><pre><strong>输入：</strong>edges = [[1,2],[1,3],[2,3]]<br><strong>输出：</strong>[2,3]<br></pre> <br><p><strong class="example">示例 2：</strong></p> <br><img alt="" src="https://img-blog.csdnimg.cn/img_convert/ff1fb135e2c964dcedd5fb3adc7b960c.jpeg" /> <br><pre><strong>输入：</strong>edges = [[1,2],[2,3],[3,4],[4,1],[1,5]]<br><strong>输出：</strong>[4,1]<br></pre> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li><code>n == edges.length</code></li><li><code>3 <= n <= 1000</code></li><li><code>edges[i].length == 2</code></li><li><code>1 <= u<sub>i</sub>, v<sub>i</sub> <= n</code></li></ul> <br><h3><a id="_42"></a>解题方法：并查集</h3> <br><p><img src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fcdn.letmefly.xyz%2Fimg%2Ftag%2Fbingchaji.jpg&pos_id=img-EVH9UtZE-1730637716505" alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" /></p> <br><h4><a id="_46"></a>解题思路</h4> <br><p>这题和<a href="https://blog.letmefly.xyz/2024/11/02/LeetCode%200684.%E5%86%97%E4%BD%99%E8%BF%9E%E6%8E%A5/" rel="nofollow">684.冗余连接</a>的区别是：</p> <br><blockquote> <br> <p>684的无向图只需要考虑有没有形成自环，而本题有向图还需要考虑“是否形成了入度为2的节点”。</p> <br></blockquote> <br><p>如果形成了“入度为2”的节点，例如下面两种情况，在<code>684.冗余连接</code>中只需要移除“首次形成(无向)环”的边，而在<code>685.冗余连接II</code>中就不能只移除“最后出现的导致形成(无向)环的边”：</p> <br><blockquote> <br> <pre><code>1----->2      1------+<br>↑      ↑      ↑      ↓<br>3------+      2<-----3<---4<br></code></pre> <br> <p>左图中只能移除<code>[1,2]</code>或<code>[3,2]</code>而不能移除<code>[3,1]</code>；右图中只能移除<code>[1,3]</code>而不能移除<code>[3,2]</code>或<code>[2,1]</code>。</p> <br></blockquote> <br><p>有向边不能和无向边一概而论的本质原因是：树中一个节点不能有两个父节点，即入度不能为<code>2</code>。所以，一旦出现了入度为<code>2</code>的节点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>     <br>      <br>       <br>       <br>         n <br>        <br>       <br>         o <br>        <br>       <br>         d <br>        <br>       <br>         e <br>        <br>       <br>      <br>        node <br>       <br>      <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span></span></span>，就要在“终点为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>     <br>      <br>       <br>       <br>         n <br>        <br>       <br>         o <br>        <br>       <br>         d <br>        <br>       <br>         e <br>        <br>       <br>      <br>        node <br>       <br>      <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span></span></span>的两条边”里面选择一条移除。判断方法如下：</p> <br><blockquote> <br> <p>尝试移除一条边，判断剩下的边（不考虑方向）能否构成无向环，如果不构成无向环则说明这条边可以被移除。</p> <br> <p>判断方法就和<code>684</code>题一模一样了，使用并查集即可完成判断。</p> <br></blockquote> <br><p>树上多一条边就一定存在入度为2的节点吗？不一定，还可能有以下这种情况：</p> <br><blockquote> <br> <pre><code>1------+<br>↑      ↓<br>2<-----3----->4<br></code></pre> <br> <p>图中节点<code>[1,2,3]</code>形成了一个环，但<code>1</code>、<code>2</code>、<code>3</code>、<code>4</code>4个节点的入度都为<code>1</code>。</p> <br> <p>这样就和<code>684</code>题一模一样了其实，在环<code>[1,2,3]</code>里任意移除一条边图都能变成树。</p> <br> <p>同样使用并查集，返回第一条“形成环”的边即为所求。</p> <br></blockquote> <br><h4><a id="_82"></a>解题方法</h4> <br><p>首先统计是否有入度为<code>2</code>的节点：</p> <br><ul><li>若有，则尝试移除指向<code>2</code>的边（若移除后图中无环则这条边可以被移除）</li><li>否则，移除第一条导致“环出现”的边</li></ul> <br><h4><a id="QA_89"></a>常见问题回答Q&A</h4> <br><p><strong>Q1：</strong> 若有入度为2的节点，在判断“移除一条边后图是否为树”时，能否通过“统计每个点是否孤立(入度出度都为0)”来判断？</p> <br><p>例如下图中终点为<code>3</code>的边有<code>[1,3]</code>和<code>[4,3]</code>两条，移除<code>[4,3]</code>的话会导致点<code>4</code>成为孤立点，因此只能移除<code>[1,3]</code>。</p> <br><pre><code>1------+<br>↑      ↓<br>2<-----3<---4<br></code></pre> <br><p><strong>A1：</strong> 不能这么判断。例如下图只能移除<code>[2,4]</code>不能移除<code>[5,2]</code>，但其实移除其中的任意一条都不会产生“孤立点”。</p> <br><pre><code>+---+<br>↓   ↑<br>4-->2<br>    ↑<br>1-->5-->3<br></code></pre> <br><p>建议修改为“通过判断图是否联通”的方式判断某条边是否可以移除。</p> <br><h4><a id="_113"></a>时空复杂度</h4> <br><ul><li>时间复杂度最坏<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          log <br>         <br>        <br>          ⁡ <br>         <br>        <br>          n <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(n\log n) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.0139em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>，平均为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          α <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          ) <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(n\alpha(n)) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span>（接近<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(n) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>）</li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(n) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></li></ul> <br><h4><a id="AC_118"></a>AC代码</h4> <br><h5><a id="C_120"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">private</span><span class="token operator">:</span><br>    vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span> fa<span class="token punctuation">;</span><br><br>    <span class="token keyword">bool</span> <span class="token function">couldRemoveThisEdge</span><span class="token punctuation">(</span>vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&</span> edges<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token function">initFa</span><span class="token punctuation">(</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> index<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">continue</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">find</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token function">union_</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&</span> edges<span class="token punctuation">,</span> <span class="token keyword">int</span> node<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">&&</span> <span class="token function">couldRemoveThisEdge</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// FAKE RETURN</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">!=</span> fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">void</span> <span class="token function">union_</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        fa<span class="token punctuation">[</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">void</span> <span class="token function">initFa</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        fa<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            fa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token function">initFa</span><span class="token punctuation">(</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">find</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> edge<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token function">union_</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// FAKE RETURN</span><br>    <span class="token punctuation">}</span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">findRedundantDirectedConnection</span><span class="token punctuation">(</span>vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        vector<span class="token operator"><</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token function">inDegree</span><span class="token punctuation">(</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>inDegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 找到了入度为2的点</span><br>                <span class="token keyword">return</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                inDegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><h5><a id="Python_194"></a>Python</h5> <br><pre><code class="prism language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<br><br><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span><br>    <span class="token keyword">def</span> <span class="token function">initFa</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span><br>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<br>    <br>    <span class="token keyword">def</span> <span class="token function">find</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span><br>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">!=</span> x<span class="token punctuation">:</span><br>            self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><br>    <br>    <span class="token keyword">def</span> <span class="token function">union</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>y<span class="token punctuation">)</span><br>    <br>    <span class="token keyword">def</span> <span class="token function">couldRemoveThisEdge</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>initFa<span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            <span class="token keyword">if</span> i <span class="token operator">==</span> index<span class="token punctuation">:</span><br>                <span class="token keyword">continue</span><br>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>                <span class="token keyword">return</span> <span class="token boolean">False</span><br>            <span class="token keyword">else</span><span class="token punctuation">:</span><br>                self<span class="token punctuation">.</span>union<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> <span class="token boolean">True</span><br><br>    <span class="token keyword">def</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>edges<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token keyword">and</span> self<span class="token punctuation">.</span>couldRemoveThisEdge<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span><br>                <span class="token keyword">return</span> self<span class="token punctuation">.</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><br>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># FAKE RETURN</span><br><br>    <span class="token keyword">def</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>initFa<span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> self<span class="token punctuation">.</span>edges<span class="token punctuation">:</span><br>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>find<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span><br>                <span class="token keyword">return</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><br>            <span class="token keyword">else</span><span class="token punctuation">:</span><br>                self<span class="token punctuation">.</span>union<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># FAKE RETURN</span><br>    <br>    <span class="token keyword">def</span> <span class="token function">findRedundantDirectedConnection</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> edges<span class="token punctuation">:</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>fa <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>        self<span class="token punctuation">.</span>edges <span class="token operator">=</span> edges<br>        hasIndegree <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> edges<span class="token punctuation">:</span><br>            <span class="token keyword">if</span> hasIndegree<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">:</span><br>                <span class="token keyword">return</span> self<span class="token punctuation">.</span>solution_indegree<span class="token punctuation">(</span>y<span class="token punctuation">)</span><br>            <span class="token keyword">else</span><span class="token punctuation">:</span><br>                hasIndegree<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span><br>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>solution_unionFind<span class="token punctuation">(</span><span class="token punctuation">)</span><br></code></pre> <br><h5><a id="Java_250"></a>Java</h5> <br><pre><code class="prism language-java"><span class="token keyword">class</span> <span class="token class-name">UnionFind</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fa<span class="token punctuation">;</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        fa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator"><=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            fa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">!=</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isUnion</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">return</span> <span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        fa<span class="token punctuation">[</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">canRemoveThisEdge</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token class-name">UnionFind</span> unionFind <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span>edges<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> edges<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> index<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">continue</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>unionFind<span class="token punctuation">.</span><span class="token function">isUnion</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                unionFind<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">,</span> <span class="token keyword">int</span> node<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> edges<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">&&</span> <span class="token function">canRemoveThisEdge</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// FAKE RETURN</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token class-name">UnionFind</span> unionFind <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span>edges<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>unionFind<span class="token punctuation">.</span><span class="token function">isUnion</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> edge<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                unionFind<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// FAKE RETURN</span><br>    <span class="token punctuation">}</span><br>    <br>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findRedundantDirectedConnection</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hasIndegree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>edges<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> edge <span class="token operator">:</span> edges<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>hasIndegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">return</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                hasIndegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre> <br><h5><a id="Go_330"></a>Go</h5> <br><pre><code class="prism language-go"><span class="token keyword">package</span> main<br><br><span class="token keyword">type</span> UnionFind <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span><br>    fa <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> UnionFind <span class="token punctuation">{<!-- --></span><br>    fa <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token keyword">for</span> th<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token keyword">range</span> fa <span class="token punctuation">{<!-- --></span><br>        fa<span class="token punctuation">[</span>th<span class="token punctuation">]</span> <span class="token operator">=</span> th<br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> UnionFind<span class="token punctuation">{<!-- --></span>fa<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token punctuation">(</span>unionFind UnionFind<span class="token punctuation">)</span> <span class="token function">_find</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">if</span> unionFind<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">!=</span> x <span class="token punctuation">{<!-- --></span><br>        unionFind<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> unionFind<span class="token punctuation">.</span><span class="token function">_find</span><span class="token punctuation">(</span>unionFind<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> unionFind<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>x<span class="token punctuation">]</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token punctuation">(</span>unionFind UnionFind<span class="token punctuation">)</span> <span class="token function">isUnion</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">return</span> unionFind<span class="token punctuation">.</span><span class="token function">_find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> unionFind<span class="token punctuation">.</span><span class="token function">_find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token punctuation">(</span>unionFind UnionFind<span class="token punctuation">)</span> <span class="token function">union</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>    unionFind<span class="token punctuation">.</span>fa<span class="token punctuation">[</span>unionFind<span class="token punctuation">.</span><span class="token function">_find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> unionFind<span class="token punctuation">.</span><span class="token function">_find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">canRemoveThisEdge</span><span class="token punctuation">(</span>edges <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> index <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{<!-- --></span><br>    unionFind <span class="token operator">:=</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> <span class="token function">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> i <span class="token operator">==</span> index <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">continue</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">if</span> unionFind<span class="token punctuation">.</span><span class="token function">isUnion</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">return</span> <span class="token boolean">false</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>            unionFind<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> <span class="token boolean">true</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>edges <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> node <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span><br>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">&&</span> <span class="token function">canRemoveThisEdge</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">return</span> edges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// FAKE RETURN</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>edges <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span><br>    unionFind <span class="token operator">:=</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> edge <span class="token operator">:=</span> <span class="token keyword">range</span> edges <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> unionFind<span class="token punctuation">.</span><span class="token function">isUnion</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">return</span> edge<br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>            unionFind<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// FAKE RETURN</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">findRedundantDirectedConnection</span><span class="token punctuation">(</span>edges <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span><br>    hasIndegree <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">bool</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> edge <span class="token operator">:=</span> <span class="token keyword">range</span> edges <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> hasIndegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">return</span> <span class="token function">solution_indegree</span><span class="token punctuation">(</span>edges<span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>            hasIndegree<span class="token punctuation">[</span>edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> <span class="token function">solution_unionFind</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><br><span class="token punctuation">}</span><br></code></pre> <br><blockquote> <br> <p>同步发文于CSDN和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2024/11/03/LeetCode%200685.%E5%86%97%E4%BD%99%E8%BF%9E%E6%8E%A5II/" rel="nofollow">原文链接</a>哦~</p> <br> <p>Tisfy：<a href="https://letmefly.blog.csdn.net/article/details/143470538" rel="nofollow">https://letmefly.blog.csdn.net/article/details/143470538</a></p> <br></blockquote>