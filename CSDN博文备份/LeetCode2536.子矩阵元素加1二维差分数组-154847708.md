<h2><a id="LetMeFly2536_1_1"></a>【LetMeFly】2536.子矩阵元素加 1：二维差分数组</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/increment-submatrices-by-one/" rel="nofollow">https://leetcode.cn/problems/increment-submatrices-by-one/</a></p> <br><p>给你一个正整数 <code>n</code> ，表示最初有一个 <code>n x n</code> 、下标从 <strong>0</strong> 开始的整数矩阵 <code>mat</code> ，矩阵中填满了 0 。</p> <br><p>另给你一个二维整数数组 <code>query</code> 。针对每个查询 <code>query[i] = [row1<sub>i</sub>, col1<sub>i</sub>, row2<sub>i</sub>, col2<sub>i</sub>]</code> ，请你执行下述操作：</p> <br><ul><li>找出 <strong>左上角</strong> 为 <code>(row1<sub>i</sub>, col1<sub>i</sub>)</code> 且 <strong>右下角</strong> 为 <code>(row2<sub>i</sub>, col2<sub>i</sub>)</code> 的子矩阵，将子矩阵中的 <strong>每个元素</strong> 加 <code>1</code> 。也就是给所有满足 <code>row1<sub>i</sub> <= x <= row2<sub>i</sub></code> 和 <code>col1<sub>i</sub> <= y <= col2<sub>i</sub></code> 的 <code>mat[x][y]</code> 加 <code>1</code> 。</li></ul> <br><p>返回执行完所有操作后得到的矩阵 <code>mat</code> 。</p> <br><p> </p> <br><p><strong>示例 1：</strong></p> <br><p><img alt="" src="https://i-blog.csdnimg.cn/img_convert/079c270b2bbbc79918c0f039c6ba9f8d.png" /></p> <br><pre><strong>输入：</strong>n = 3, queries = [[1,1,2,2],[0,0,1,1]]<br><strong>输出：</strong>[[1,1,0],[1,2,1],[0,1,1]]<br><strong>解释：</strong>上图所展示的分别是：初始矩阵、执行完第一个操作后的矩阵、执行完第二个操作后的矩阵。<br>- 第一个操作：将左上角为 (1, 1) 且右下角为 (2, 2) 的子矩阵中的每个元素加 1 。 <br>- 第二个操作：将左上角为 (0, 0) 且右下角为 (1, 1) 的子矩阵中的每个元素加 1 。 <br></pre> <br><p><strong>示例 2：</strong></p> <br><p><img alt="" src="https://i-blog.csdnimg.cn/img_convert/c2380439fd07f7f84611115e1a8fd0c8.png" /></p> <br><pre><strong>输入：</strong>n = 2, queries = [[0,0,1,1]]<br><strong>输出：</strong>[[1,1],[1,1]]<br><strong>解释：</strong>上图所展示的分别是：初始矩阵、执行完第一个操作后的矩阵。 <br>- 第一个操作：将矩阵中的每个元素加 1 。</pre> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li><code>1 <= n <= 500</code></li><li><code>1 <= queries.length <= 10<sup>4</sup></code></li><li><code>0 <= row1<sub>i</sub> <= row2<sub>i</sub> < n</code></li><li><code>0 <= col1<sub>i</sub> <= col2<sub>i</sub> < n</code></li></ul> <br><p>Long time no see.</p> <br><h3><a id="_52"></a>解题方法：二维差分数组</h3> <br><p>使用二维差分数组<code>diff</code>，其中令<code>diff[i][j]</code>表示原数组<code>mat[i][j]</code>到<code>mat[n-1][n-1]</code>每个元素变化值。</p> <br><p>例如将<code>mat[x1][y1]</code>到<code>mat[x2][y2]</code>每个元素值加一，反映到差分数组上就表现为：</p> <br><ol><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         d<br>        <br>        <br>         i<br>        <br>        <br>         f<br>        <br>        <br>         f<br>        <br>        <br>         [<br>        <br>        <br>         x<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         [<br>        <br>        <br>         y<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         +<br>        <br>        <br>         =<br>        <br>        <br>         1<br>        <br>       <br>       <br>        diff[x1][y1] += 1<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，先从<code>mat[x1][y1]</code>到<code>mat[n-1][n-1]</code>每个元素都加一</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         d<br>        <br>        <br>         i<br>        <br>        <br>         f<br>        <br>        <br>         f<br>        <br>        <br>         [<br>        <br>        <br>         x<br>        <br>        <br>         2<br>        <br>        <br>         +<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         [<br>        <br>        <br>         y<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         −<br>        <br>        <br>         =<br>        <br>        <br>         1<br>        <br>       <br>       <br>        diff[x2+1][y1] -= 1<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord">1</span><span class="mclose">]</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，由于从<code>mat[x2+1][y1]</code>到<code>mat[n-1][n-1]</code>每个元素无需改变，第一步加的范围太大了，不该变的撤销变化</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         d<br>        <br>        <br>         i<br>        <br>        <br>         f<br>        <br>        <br>         f<br>        <br>        <br>         [<br>        <br>        <br>         x<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         [<br>        <br>        <br>         y<br>        <br>        <br>         2<br>        <br>        <br>         +<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         −<br>        <br>        <br>         =<br>        <br>        <br>         1<br>        <br>       <br>       <br>        diff[x1][y2+1] -= 1<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，与2同理，由于从<code>mat[x1][y2+1]</code>到<code>mat[n-1][n-1]</code>每个元素无需改变，第一步加的范围太大了，不该变的撤销变化</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         d<br>        <br>        <br>         i<br>        <br>        <br>         f<br>        <br>        <br>         f<br>        <br>        <br>         [<br>        <br>        <br>         x<br>        <br>        <br>         2<br>        <br>        <br>         +<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         [<br>        <br>        <br>         y<br>        <br>        <br>         2<br>        <br>        <br>         +<br>        <br>        <br>         1<br>        <br>        <br>         ]<br>        <br>        <br>         +<br>        <br>        <br>         =<br>        <br>        <br>         1<br>        <br>       <br>       <br>        diff[x2+1][y2+1] += 1<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，由于第二步和第三步都包含范围<code>mat[x2+1][y2+1]</code>，所以这块“重复撤销”了，再加回来</li></ol> <br><p>对于每个query，以<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        O<br>       <br>       <br>        (<br>       <br>       <br>        1<br>       <br>       <br>        )<br>       <br>      <br>      <br>       O(1)<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>的时间复杂度可以计算出diff数组的变化。最终处理完所有query，再由diff差分数组反推出原数组mat就好了。</p> <br><p>二维数组思考困难的话可以以一位数组为例，一位差分数组的前缀和数组就是原始数组，二维数组也是如此。只需要对diff数组求前缀和，就能得到原始mat数组了。</p> <br><p>前缀和<code>prefix[i][j]</code>代表从<code>diff[0][0]</code>到<code>diff[i][j]</code>的所有元素之和。求前缀和的过程可以由左上到右下的顺序求得。</p> <br><p>和求差分数组过程类似，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        p<br>       <br>       <br>        r<br>       <br>       <br>        e<br>       <br>       <br>        f<br>       <br>       <br>        i<br>       <br>       <br>        x<br>       <br>       <br>        [<br>       <br>       <br>        i<br>       <br>       <br>        ]<br>       <br>       <br>        [<br>       <br>       <br>        j<br>       <br>       <br>        ]<br>       <br>       <br>        =<br>       <br>       <br>        d<br>       <br>       <br>        i<br>       <br>       <br>        f<br>       <br>       <br>        f<br>       <br>       <br>        [<br>       <br>       <br>        i<br>       <br>       <br>        ]<br>       <br>       <br>        [<br>       <br>       <br>        j<br>       <br>       <br>        ]<br>       <br>       <br>        +<br>       <br>       <br>        p<br>       <br>       <br>        r<br>       <br>       <br>        e<br>       <br>       <br>        f<br>       <br>       <br>        i<br>       <br>       <br>        x<br>       <br>       <br>        [<br>       <br>       <br>        i<br>       <br>       <br>        −<br>       <br>       <br>        1<br>       <br>       <br>        ]<br>       <br>       <br>        [<br>       <br>       <br>        j<br>       <br>       <br>        ]<br>       <br>       <br>        +<br>       <br>       <br>        p<br>       <br>       <br>        r<br>       <br>       <br>        e<br>       <br>       <br>        f<br>       <br>       <br>        i<br>       <br>       <br>        x<br>       <br>       <br>        [<br>       <br>       <br>        i<br>       <br>       <br>        ]<br>       <br>       <br>        [<br>       <br>       <br>        j<br>       <br>       <br>        −<br>       <br>       <br>        1<br>       <br>       <br>        ]<br>       <br>       <br>        −<br>       <br>       <br>        p<br>       <br>       <br>        r<br>       <br>       <br>        e<br>       <br>       <br>        f<br>       <br>       <br>        i<br>       <br>       <br>        x<br>       <br>       <br>        [<br>       <br>       <br>        i<br>       <br>       <br>        −<br>       <br>       <br>        1<br>       <br>       <br>        ]<br>       <br>       <br>        [<br>       <br>       <br>        j<br>       <br>       <br>        −<br>       <br>       <br>        1<br>       <br>       <br>        ]<br>       <br>      <br>      <br>       prefix[i][j] = diff[i][j] + prefix[i-1][j] + prefix[i][j-1] - prefix[i-1][j-1]<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>。</p> <br><p>解释为：从<code>diff[0][0]</code>到<code>diff[i][j]</code>的所有元素之和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        =<br>       <br>      <br>      <br>       =<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">=</span></span></span></span></span> 从<code>diff[0][0]</code>到<code>diff[i-1][j]</code>的所有元素之和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        +<br>       <br>      <br>      <br>       +<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">+</span></span></span></span></span> 从<code>diff[0][0]</code>到<code>diff[i][j-]</code>的所有元素之和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        −<br>       <br>      <br>      <br>       -<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">−</span></span></span></span></span> 从<code>diff[0][0]</code>到<code>diff[i-1][j-1]</code>的所有元素之和（算重了）。</p> <br><ul><li>时间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         <br>          n<br>         <br>         <br>          2<br>         <br>        <br>        <br>         +<br>        <br>        <br>         l<br>        <br>        <br>         e<br>        <br>        <br>         n<br>        <br>        <br>         (<br>        <br>        <br>         q<br>        <br>        <br>         u<br>        <br>        <br>         e<br>        <br>        <br>         r<br>        <br>        <br>         i<br>        <br>        <br>         e<br>        <br>        <br>         s<br>        <br>        <br>         )<br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(n^2+len(queries))<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">i</span><span class="mord mathnormal">es</span><span class="mclose">))</span></span></span></span></span></li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         <br>          n<br>         <br>         <br>          2<br>         <br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(n^2)<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ul> <br><h4><a id="AC_76"></a>AC代码</h4> <br><h5><a id="C_78"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token comment">/*<br> * @LastEditTime: 2025-11-14 18:07:20<br> */</span><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">rangeAddQueries</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&</span> queries<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">diff</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> q <span class="token operator">:</span> queries<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">int</span> x1 <span class="token operator">=</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y1 <span class="token operator">=</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x2 <span class="token operator">=</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y2 <span class="token operator">=</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>            diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span><br>            diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span><br>            diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span><br>            diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        vector<span class="token operator"><</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">ans</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator"><</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <br>                            <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><br>                            <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>                            <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><h5><a id="Python_109"></a>Python</h5> <br><pre><code class="prism language-python"><span class="token triple-quoted-string string">'''<br>LastEditTime: 2025-11-14 19:16:40<br>'''</span><br><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<br><br><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span><br>    <span class="token keyword">def</span> <span class="token function">rangeAddQueries</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> queries<span class="token punctuation">:</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        diff <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><br>        <span class="token keyword">for</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token keyword">in</span> queries<span class="token punctuation">:</span><br>            diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><br>            diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><br>            diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><br>            diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><br>        ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> n <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><br>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span><br>            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span><br>                ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> \<br>                            <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> <span class="token keyword">not</span> i <span class="token keyword">else</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> \<br>                            <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> <span class="token keyword">not</span> j <span class="token keyword">else</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> \<br>                            <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> <span class="token keyword">not</span> i <span class="token keyword">or</span> <span class="token keyword">not</span> j <span class="token keyword">else</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> ans<br></code></pre> <br><h5><a id="Go_135"></a>Go</h5> <br><pre><code class="prism language-go"><span class="token comment">/*<br> * @Author: LetMeFly<br> * @Date: 2025-11-14 19:38:51<br> * @LastEditors: LetMeFly.xyz<br> * @LastEditTime: 2025-11-14 19:46:39<br> */</span><br><span class="token keyword">package</span> main<br><br><span class="token keyword">func</span> <span class="token function">rangeAddQueries</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> queries <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span><br>    diff <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> diff <span class="token punctuation">{<!-- --></span><br>        diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> q <span class="token operator">:=</span> <span class="token keyword">range</span> queries <span class="token punctuation">{<!-- --></span><br>        x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token operator">:=</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><br>        diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span><span class="token operator">++</span><br>        diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y1<span class="token punctuation">]</span><span class="token operator">--</span><br>        diff<span class="token punctuation">[</span>x1<span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><br>        diff<span class="token punctuation">[</span>x2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>y2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">++</span><br>    <span class="token punctuation">}</span><br><br>    ans <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><br>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> ans <span class="token punctuation">{<!-- --></span><br>        ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> ans <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token keyword">range</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span><br>            up <span class="token operator">:=</span> <span class="token number">0</span><br>            <span class="token keyword">if</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span><br>                up <span class="token operator">=</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><br>            <span class="token punctuation">}</span><br>            left <span class="token operator">:=</span> <span class="token number">0</span><br>            <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span><br>                left <span class="token operator">=</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><br>            <span class="token punctuation">}</span><br>            lu <span class="token operator">:=</span> <span class="token number">0</span><br>            <span class="token keyword">if</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&&</span> j <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span><br>                lu <span class="token operator">=</span> ans<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><br>            <span class="token punctuation">}</span><br>            ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> left <span class="token operator">+</span> up <span class="token operator">-</span> lu<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> ans<br><span class="token punctuation">}</span><br></code></pre> <br><blockquote> <br> <p>同步发文于<a href="https://letmefly.blog.csdn.net/article/details/154847708" rel="nofollow">CSDN</a>和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2025/11/14/LeetCode%202536.%E5%AD%90%E7%9F%A9%E9%98%B5%E5%85%83%E7%B4%A0%E5%8A%A01/" rel="nofollow">原文链接</a>哦~</p> <br> <p>千篇源码题解<a href="https://github.com/LetMeFly666/LeetCode">已开源</a></p> <br></blockquote>