<h2><a id="LetMeFly1870_0"></a>【LetMeFly】1870.准时到达的列车最小时速：二分查找（避免浮点误差）</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/minimum-speed-to-arrive-on-time/" rel="nofollow">https://leetcode.cn/problems/minimum-speed-to-arrive-on-time/</a></p> <br><p>给你一个浮点数 <code>hour</code> ，表示你到达办公室可用的总通勤时间。要到达办公室，你必须按给定次序乘坐 <code>n</code> 趟列车。另给你一个长度为 <code>n</code> 的整数数组 <code>dist</code> ，其中 <code>dist[i]</code> 表示第 <code>i</code> 趟列车的行驶距离（单位是千米）。</p> <br><p>每趟列车均只能在整点发车，所以你可能需要在两趟列车之间等待一段时间。</p> <br><ul><li>例如，第 <code>1</code> 趟列车需要 <code>1.5</code> 小时，那你必须再等待 <code>0.5</code> 小时，搭乘在第 2 小时发车的第 <code>2</code> 趟列车。</li></ul> <br><p>返回能满足你准时到达办公室所要求全部列车的<strong> 最小正整数 </strong>时速（单位：千米每小时），如果无法准时到达，则返回 <code>-1</code> 。</p> <br><p>生成的测试用例保证答案不超过 <code>10<sup>7</sup></code> ，且 <code>hour</code> 的 <strong>小数点后最多存在两位数字</strong> 。</p> <br><p> </p> <br><p><strong>示例 1：</strong></p> <br><pre><strong>输入：</strong>dist = [1,3,2], hour = 6<br><strong>输出：</strong>1<br><strong>解释：</strong>速度为 1 时：<br>- 第 1 趟列车运行需要 1/1 = 1 小时。<br>- 由于是在整数时间到达，可以立即换乘在第 1 小时发车的列车。第 2 趟列车运行需要 3/1 = 3 小时。<br>- 由于是在整数时间到达，可以立即换乘在第 4 小时发车的列车。第 3 趟列车运行需要 2/1 = 2 小时。<br>- 你将会恰好在第 6 小时到达。<br></pre> <br><p><strong>示例 2：</strong></p> <br><pre><strong>输入：</strong>dist = [1,3,2], hour = 2.7<br><strong>输出：</strong>3<br><strong>解释：</strong>速度为 3 时：<br>- 第 1 趟列车运行需要 1/3 = 0.33333 小时。<br>- 由于不是在整数时间到达，故需要等待至第 1 小时才能搭乘列车。第 2 趟列车运行需要 3/3 = 1 小时。<br>- 由于是在整数时间到达，可以立即换乘在第 2 小时发车的列车。第 3 趟列车运行需要 2/3 = 0.66667 小时。<br>- 你将会在第 2.66667 小时到达。</pre> <br><p><strong>示例 3：</strong></p> <br><pre><strong>输入：</strong>dist = [1,3,2], hour = 1.9<br><strong>输出：</strong>-1<br><strong>解释：</strong>不可能准时到达，因为第 3 趟列车最早是在第 2 小时发车。</pre> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li><code>n == dist.length</code></li><li><code>1 <= n <= 10<sup>5</sup></code></li><li><code>1 <= dist[i] <= 10<sup>5</sup></code></li><li><code>1 <= hour <= 10<sup>9</sup></code></li><li><code>hours</code> 中，小数点后最多存在两位数字</li></ul> <br><h3><a id="_62"></a>解题方法：二分查找</h3> <br><p>速度越快耗时越短，因此直接二分查找确定最小速度即可。速度下限为<code>1</code>，速度上限为<code>10^7</code>（这是因为每一段路程最多<code>10^5</code>，速度再大，前面每段路程的耗时也至少得为<code>1</code>；由于时间精度是<code>0.01</code>，所以速度再快只会让最后一段路程耗时为一个更小的分数<code>0.001</code>无意义）</p> <br><p>如何避免精度误差？当然是把一切结果都转为整数运算。首先对于给定时间，直接乘以<code>100</code>并转为整数（例如C++的<code>llround</code>和python的<code>round</code>）。前面每段路程计算时间时，本来就是整数；最后一段路程计算时间时，将除法转换为乘法：</p> <br><p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>     <br>      <br>       <br>       <br>         前面时间 <br>        <br>       <br>         × <br>        <br>       <br>         100 <br>        <br>       <br>         + <br>        <br>        <br>         <br>         <br>           最后一段路程 <br>          <br>         <br>           × <br>          <br>         <br>           100 <br>          <br>         <br>        <br>          速度 <br>         <br>        <br>       <br>         ≤ <br>        <br>       <br>         r <br>        <br>       <br>         o <br>        <br>       <br>         u <br>        <br>       <br>         n <br>        <br>       <br>         d <br>        <br>       <br>         ( <br>        <br>       <br>         h <br>        <br>       <br>         o <br>        <br>       <br>         u <br>        <br>       <br>         r <br>        <br>       <br>         × <br>        <br>       <br>         100 <br>        <br>       <br>         ) <br>          <br>       <br>         ⟺ <br>          <br>       <br>         ( <br>        <br>       <br>         r <br>        <br>       <br>         o <br>        <br>       <br>         u <br>        <br>       <br>         n <br>        <br>       <br>         d <br>        <br>       <br>         ( <br>        <br>       <br>         h <br>        <br>       <br>         o <br>        <br>       <br>         u <br>        <br>       <br>         r <br>        <br>       <br>         × <br>        <br>       <br>         100 <br>        <br>       <br>         ) <br>        <br>       <br>         − <br>        <br>       <br>         前面时间 <br>        <br>       <br>         × <br>        <br>       <br>         100 <br>        <br>       <br>         ) <br>        <br>       <br>         × <br>        <br>       <br>         速度 <br>        <br>       <br>         ≥ <br>        <br>       <br>         最后一段路程 <br>        <br>       <br>         × <br>        <br>       <br>         100 <br>        <br>       <br>      <br>        前面时间\times 100+\frac{最后一段路程\times 100}{速度}\leq round(hour\times 100)\iff (round(hour\times 100)-前面时间\times 100)\times 速度\geq 最后一段路程\times 100 <br>       <br>      <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord cjk_fallback">前面时间</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">100</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.2173em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8723em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">速度</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">最后一段路程</span><span class="mbin mtight">×</span><span class="mord mtight">100</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ro</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">100</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">100</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord cjk_fallback">前面时间</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">100</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8193em; vertical-align: -0.136em;"></span><span class="mord cjk_fallback">速度</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord cjk_fallback">最后一段路程</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100</span></span></span></span></span></p> <br><ul><li>时间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          n <br>         <br>        <br>          log <br>         <br>        <br>          ⁡ <br>         <br>        <br>          C <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(n\log C) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.0139em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mclose">)</span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          C <br>         <br>        <br>          = <br>         <br>        <br>          1 <br>         <br>         <br>         <br>           0 <br>          <br>         <br>           7 <br>          <br>         <br>        <br>       <br>         C=10^7 <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span></li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> <br>      <br>       <br>        <br>        <br>          O <br>         <br>        <br>          ( <br>         <br>        <br>          1 <br>         <br>        <br>          ) <br>         <br>        <br>       <br>         O(1) <br>        <br>       <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></li></ul> <br><h4><a id="AC_73"></a>AC代码</h4> <br><h5><a id="C_75"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">private</span><span class="token operator">:</span><br>    <span class="token keyword">bool</span> <span class="token function">ok</span><span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> dist<span class="token punctuation">,</span> ll hour<span class="token punctuation">,</span> <span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        ll t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator"><</span> dist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            t <span class="token operator">+=</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> speed <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> speed<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token punctuation">(</span>hour <span class="token operator">-</span> t <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">*</span> speed <span class="token operator">>=</span> dist<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    <span class="token keyword">int</span> <span class="token function">minSpeedOnTime</span><span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> dist<span class="token punctuation">,</span> <span class="token keyword">double</span> hour<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        ll hour100 <span class="token operator">=</span> <span class="token function">llround</span><span class="token punctuation">(</span>hour <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1e7</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><br>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator"><</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ok</span><span class="token punctuation">(</span>dist<span class="token punctuation">,</span> hour100<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                r <span class="token operator">=</span> mid<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span><br>                l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> l <span class="token operator">==</span> <span class="token number">1e7</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> l<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><h5><a id="Python_105"></a>Python</h5> <br><pre><code class="prism language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<br><br><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span><br>    <span class="token keyword">def</span> <span class="token function">ok</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> speed<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span><br>        t <span class="token operator">=</span> <span class="token number">0</span><br>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>dist<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            t <span class="token operator">+=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> speed <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> speed<br>        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>hour <span class="token operator">-</span> t <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">*</span> speed <span class="token operator">>=</span> self<span class="token punctuation">.</span>dist<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">100</span><br>    <br>    <span class="token keyword">def</span> <span class="token function">minSpeedOnTime</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dist<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> hour<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>dist <span class="token operator">=</span> dist<br>        self<span class="token punctuation">.</span>hour <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>hour <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><br>        l<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1e7</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><br>        <span class="token keyword">while</span> l <span class="token operator"><</span> r<span class="token punctuation">:</span><br>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><br>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>ok<span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">:</span><br>                r <span class="token operator">=</span> mid<br>            <span class="token keyword">else</span><span class="token punctuation">:</span><br>                l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><br>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">if</span> l <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1e7</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">else</span> l<br><br></code></pre> <br><blockquote> <br> <p>同步发文于CSDN和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2024/10/02/LeetCode%201870.%E5%87%86%E6%97%B6%E5%88%B0%E8%BE%BE%E7%9A%84%E5%88%97%E8%BD%A6%E6%9C%80%E5%B0%8F%E6%97%B6%E9%80%9F/" rel="nofollow">原文链接</a>哦~</p> <br> <p>Tisfy：<a href="https://letmefly.blog.csdn.net/article/details/142680612" rel="nofollow">https://letmefly.blog.csdn.net/article/details/142680612</a></p> <br></blockquote>