<h2><a id="LetMeFly865DFS__Python5_1"></a>【LetMeFly】865.具有所有最深节点的最小子树：深度优先搜索（一次DFS + Python5行）</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/smallest-subtree-with-all-the-deepest-nodes/" rel="nofollow">https://leetcode.cn/problems/smallest-subtree-with-all-the-deepest-nodes/</a></p> <br><p>给定一个根为 <code>root</code> 的二叉树，每个节点的深度是 <strong>该节点到根的最短距离</strong> 。</p> <br><p>返回包含原始树中所有 <strong>最深节点</strong> 的 <em>最小子树</em> 。</p> <br><p>如果一个节点在 <strong>整个树 </strong>的任意节点之间具有最大的深度，则该节点是 <strong>最深的</strong> 。</p> <br><p>一个节点的 <strong>子树</strong> 是该节点加上它的所有后代的集合。</p> <br><p> </p> <br><p><strong>示例 1：</strong></p> <br><p><img alt="" src="https://i-blog.csdnimg.cn/img_convert/b422d53392ebfc2e9ac61ffd54427265.png" /></p> <br><pre><strong>输入：</strong>root = [3,5,1,6,2,0,8,null,null,7,4]<br><strong>输出：</strong>[2,7,4]<br><strong>解释：</strong><br>我们返回值为 2 的节点，在图中用黄色标记。<br>在图中用蓝色标记的是树的最深的节点。<br>注意，节点 5、3 和 2 包含树中最深的节点，但节点 2 的子树最小，因此我们返回它。<br></pre> <br><p><strong>示例 2：</strong></p> <br><pre><strong>输入：</strong>root = [1]<br><strong>输出：</strong>[1]<br><strong>解释：</strong>根节点是树中最深的节点。</pre> <br><p><strong>示例 3：</strong></p> <br><pre><strong>输入：</strong>root = [0,1,3,null,2]<br><strong>输出：</strong>[2]<br><strong>解释：</strong>树中最深的节点为 2 ，有效子树为节点 2、1 和 0 的子树，但节点 2 的子树最小。</pre> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li>树中节点的数量在 <code>[1, 500]</code> 范围内。</li><li><code>0 <= Node.val <= 500</code></li><li>每个节点的值都是 <strong>独一无二</strong> 的。</li></ul> <br><p> </p> <br><p><strong>注意：</strong>本题与力扣 1123 重复：<a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-deepest-leaves/" target="_blank" rel="nofollow noopener noreferrer">https://leetcode-cn.com/problems/lowest-common-ancestor-of-deepest-leaves</a></p> <br><h3><a id="DFS_58"></a>解题方法：DFS</h3> <br><p>思考对于根节点<code>root</code>，答案是什么：</p> <br><ul><li>如果左子树比右子树深，说明答案一定在左子树上</li><li>如果右子树比左子树深，说明答案一定在右子树上</li><li>如果左右子树一样深，说明<code>root</code>就是答案</li></ul> <br><p>当左子树（假设为<code>left</code>节点）比右子树深时，答案是哪个呢？</p> <br><blockquote> <br> <p>答案是以<code>left</code>为节点时“含所有最深节点最小子树”的答案。</p> <br></blockquote> <br><p>好一个天然递归。递归时候都需要什么？</p> <br><ol><li>树的深度</li><li>答案节点</li></ol> <br><p>以上。</p> <br><ul><li>时间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         s<br>        <br>        <br>         i<br>        <br>        <br>         z<br>        <br>        <br>         e<br>        <br>        <br>         (<br>        <br>        <br>         r<br>        <br>        <br>         o<br>        <br>        <br>         o<br>        <br>        <br>         t<br>        <br>        <br>         )<br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(size(root))<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mopen">(</span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span></li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         d<br>        <br>        <br>         e<br>        <br>        <br>         p<br>        <br>        <br>         t<br>        <br>        <br>         h<br>        <br>        <br>         (<br>        <br>        <br>         r<br>        <br>        <br>         o<br>        <br>        <br>         o<br>        <br>        <br>         t<br>        <br>        <br>         )<br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(depth(root))<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span></li></ul> <br><h4><a id="AC_80"></a>AC代码</h4> <br><h5><a id="C_82"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token comment">/*<br> * @LastEditTime: 2026-01-09 13:19:41<br> */</span><br><span class="token keyword">typedef</span> pair<span class="token operator"><</span>TreeNode<span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> result<span class="token punctuation">;</span><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">private</span><span class="token operator">:</span><br>    result <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        result left <span class="token operator">=</span> root<span class="token operator">-></span>left <span class="token operator">?</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token operator">:</span> result<span class="token punctuation">{<!-- --></span><span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>        result right <span class="token operator">=</span> root<span class="token operator">-></span>right <span class="token operator">?</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">)</span> <span class="token operator">:</span> result<span class="token punctuation">{<!-- --></span><span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>        TreeNode<span class="token operator">*</span> node <span class="token operator">=</span> left<span class="token punctuation">.</span>second <span class="token operator">==</span> right<span class="token punctuation">.</span>second <span class="token operator">?</span> root <span class="token operator">:</span> <span class="token punctuation">(</span>left<span class="token punctuation">.</span>second <span class="token operator">></span> right<span class="token punctuation">.</span>second <span class="token operator">?</span> left<span class="token punctuation">.</span>first <span class="token operator">:</span> right<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>node<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>left<span class="token punctuation">.</span>second<span class="token punctuation">,</span> right<span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    TreeNode<span class="token operator">*</span> <span class="token function">subtreeWithAllDeepest</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><h5><a id="Python_104"></a>Python</h5> <br><pre><code class="prism language-python"><span class="token triple-quoted-string string">'''<br>LastEditTime: 2026-01-09 20:58:21<br>'''</span><br><span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional<span class="token punctuation">,</span> Tuple<br><br>empty_result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><br><br><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span><br>    <span class="token keyword">def</span> <span class="token function">dfs</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">:</span> TreeNode<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Tuple<span class="token punctuation">[</span>Optional<span class="token punctuation">[</span>TreeNode<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        left <span class="token operator">=</span> self<span class="token punctuation">.</span>dfs<span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token keyword">if</span> root<span class="token punctuation">.</span>left <span class="token keyword">else</span> empty_result<br>        right <span class="token operator">=</span> self<span class="token punctuation">.</span>dfs<span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token keyword">if</span> root<span class="token punctuation">.</span>right <span class="token keyword">else</span> empty_result<br>        <span class="token keyword">return</span> <span class="token punctuation">[</span>root <span class="token keyword">if</span> left<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> right<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">else</span> left<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> left<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> right<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">else</span> right<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>left<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> right<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><br><br>    <span class="token keyword">def</span> <span class="token function">subtreeWithAllDeepest</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">:</span> TreeNode<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> TreeNode<span class="token punctuation">:</span><br>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>dfs<span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><br></code></pre> <br><blockquote> <br> <p>同步发文于<a href="https://letmefly.blog.csdn.net/article/details/156773047" rel="nofollow">CSDN</a>和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2026/01/09/LeetCode%200865.%E5%85%B7%E6%9C%89%E6%89%80%E6%9C%89%E6%9C%80%E6%B7%B1%E8%8A%82%E7%82%B9%E7%9A%84%E6%9C%80%E5%B0%8F%E5%AD%90%E6%A0%91/" rel="nofollow">原文链接</a>哦~</p> <br> <p>千篇源码题解<a href="https://github.com/LetMeFly666/LeetCode">已开源</a></p> <br></blockquote>