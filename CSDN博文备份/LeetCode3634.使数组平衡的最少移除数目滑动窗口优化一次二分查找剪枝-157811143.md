<h2><a id="LetMeFly3634_1"></a>【LetMeFly】3634.使数组平衡的最少移除数目：滑动窗口+优化(一次二分查找+剪枝)</h2> <br><p>力扣题目链接：<a href="https://leetcode.cn/problems/minimum-removals-to-balance-array/" rel="nofollow">https://leetcode.cn/problems/minimum-removals-to-balance-array/</a></p> <br><p>给你一个整数数组 <code>nums</code> 和一个整数 <code>k</code>。</p> <br><p>如果一个数组的 <strong>最大 </strong>元素的值 <strong>至多 </strong>是其 <strong>最小 </strong>元素的 <code>k</code> 倍，则该数组被称为是 <strong>平衡 </strong>的。</p> <br><p>你可以从 <code>nums</code> 中移除 <strong>任意 </strong>数量的元素，但不能使其变为 <strong>空 </strong>数组。</p> <br><p>返回为了使剩余数组平衡，需要移除的元素的 <strong>最小 </strong>数量。</p> <br><p><strong>注意：</strong>大小为 1 的数组被认为是平衡的，因为其最大值和最小值相等，且条件总是成立。</p> <br><p> </p> <br><p><strong class="example">示例 1:</strong></p> <br><div class="example-block"> <br> <p><strong>输入：</strong><span class="example-io">nums = [2,1,5], k = 2</span></p> <br></div><br><p><strong>输出：</strong><span class="example-io">1</span></p> <br><p><strong>解释：</strong></p> <br><ul><li>移除 <code>nums[2] = 5</code> 得到 <code>nums = [2, 1]</code>。</li><li>现在 <code>max = 2</code>, <code>min = 1</code>，且 <code>max <= min * k</code>，因为 <code>2 <= 1 * 2</code>。因此，答案是 1。</li></ul> <br><p><strong class="example">示例 2:</strong></p> <br><div class="example-block"> <br> <p><strong>输入：</strong><span class="example-io">nums = [1,6,2,9], k = 3</span></p> <br></div><br><p><strong>输出：</strong><span class="example-io">2</span></p> <br><p><strong>解释：</strong></p> <br><ul><li>移除 <code>nums[0] = 1</code> 和 <code>nums[3] = 9</code> 得到 <code>nums = [6, 2]</code>。</li><li>现在 <code>max = 6</code>, <code>min = 2</code>，且 <code>max <= min * k</code>，因为 <code>6 <= 2 * 3</code>。因此，答案是 2。</li></ul> <br><p><strong class="example">示例 3:</strong></p> <br><div class="example-block"> <br> <p><strong>输入：</strong><span class="example-io">nums = [4,6], k = 2</span></p> <br></div><br><p><strong>输出：</strong><span class="example-io">0</span></p> <br><p><strong>解释：</strong></p> <br><ul><li>由于 <code>nums</code> 已经平衡，因为 <code>6 <= 4 * 2</code>，所以不需要移除任何元素。</li></ul> <br><p> </p> <br><p><strong>提示：</strong></p> <br><ul><li><code>1 <= nums.length <= 10<sup>5</sup></code></li><li><code>1 <= nums[i] <= 10<sup>9</sup></code></li><li><code>1 <= k <= 10<sup>5</sup></code></li></ul> <br><h3><a id="_73"></a>解题方法：滑动窗口</h3> <br><p>元素顺序不影响结果，首先对原始数组按从小到大排个序。</p> <br><p>枚举每一个最小元素的下标，不难发现随着最小元素的增大，最大元素也在增大。</p> <br><p>因此可以使用两个指针<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        l<br>       <br>      <br>      <br>       l<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        r<br>       <br>      <br>      <br>       r<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span></span>分别指向窗口起始下标和结束下标的下一位，那么窗口中元素则是<strong>平衡</strong>的。</p> <br><p>从<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        l<br>       <br>       <br>        =<br>       <br>       <br>        0<br>       <br>      <br>      <br>       l=0<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>开始不断右移左指针，每次确定右指针的位置，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        r<br>       <br>       <br>        −<br>       <br>       <br>        l<br>       <br>      <br>      <br>       r-l<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span></span></span></span></span>即位当前方案最多保留的元素。</p> <br><h4><a id="_83"></a>优化</h4> <br><p>对于初始<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        r<br>       <br>      <br>      <br>       r<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span></span>的确定，一共有三种方法：</p> <br><ol><li>从后往前遍历</li><li>二分查找第一个大于<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         n<br>        <br>        <br>         u<br>        <br>        <br>         m<br>        <br>        <br>         s<br>        <br>        <br>         [<br>        <br>        <br>         0<br>        <br>        <br>         ]<br>        <br>        <br>         ×<br>        <br>        <br>         k<br>        <br>       <br>       <br>        nums[0]\times k<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>的下标 （二分查找小优化）</li><li>直接不找了，从<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         r<br>        <br>        <br>         =<br>        <br>        <br>         0<br>        <br>       <br>       <br>        r=0<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>开始，第一次循环时不断往右遍历就会找到</li></ol> <br><p>如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>    <br>     <br>      <br>       <br>        r<br>       <br>      <br>      <br>       r<br>      <br>     <br>    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span></span>指针已经移出数组边界，则可提前结束左指针的右移。</p> <br><h4><a id="_93"></a>时空复杂度分析</h4> <br><ul><li>时间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         n<br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(n)<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></li><li>空间复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"><br>     <br>      <br>       <br>        <br>         O<br>        <br>        <br>         (<br>        <br>        <br>         1<br>        <br>        <br>         )<br>        <br>       <br>       <br>        O(1)<br>       <br>      <br>     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></li></ul> <br><h4><a id="AC_98"></a>AC代码</h4> <br><h5><a id="C_100"></a>C++</h5> <br><pre><code class="prism language-cpp"><span class="token comment">/*<br> * @LastEditTime: 2026-02-06 19:14:06<br> */</span><br><span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span><br><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span><br><span class="token keyword">private</span><span class="token operator">:</span><br>    <span class="token keyword">int</span> <span class="token function">getLastRIndex</span><span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> nums<span class="token punctuation">,</span> ll k<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> k <span class="token operator">></span> INT_MAX<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">return</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> <span class="token function">upper_bound</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> it <span class="token operator">-</span> nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token keyword">public</span><span class="token operator">:</span><br>    <span class="token keyword">int</span> <span class="token function">minRemoval</span><span class="token punctuation">(</span>vector<span class="token operator"><</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&</span> nums<span class="token punctuation">,</span> ll k<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>        <span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">int</span> keep <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token function">getLastRIndex</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>            <span class="token keyword">while</span> <span class="token punctuation">(</span>r <span class="token operator"><</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator"><=</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                r<span class="token operator">++</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            keep <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>keep<span class="token punctuation">,</span> r <span class="token operator">-</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">==</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><br>                <span class="token keyword">break</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> keep<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br></code></pre> <br><blockquote> <br> <p>同步发文于<a href="https://letmefly.blog.csdn.net/article/details/157811143" rel="nofollow">CSDN</a>和我的<a href="https://blog.letmefly.xyz/" rel="nofollow">个人博客</a>，原创不易，转载经作者同意后请附上<a href="https://blog.letmefly.xyz/2026/02/06/LeetCode%203634.%E4%BD%BF%E6%95%B0%E7%BB%84%E5%B9%B3%E8%A1%A1%E7%9A%84%E6%9C%80%E5%B0%91%E7%A7%BB%E9%99%A4%E6%95%B0%E7%9B%AE/" rel="nofollow">原文链接</a>哦~</p> <br> <p>千篇源码题解<a href="https://github.com/LetMeFly666/LeetCode">已开源</a></p> <br></blockquote>